# tinkof_ass
Программа считает отклонения от целевых распределений активов согласно принципу "пассивных портфельных инвестиций"
и выдает необходимые продажи/покупки в случае отклонений.

## Как использовать
Необходима версия rust не менее 1.70 и линкер mold. Работа и сборка проверялась только на Linux.

Сборка: `cargo build --release`

Запуск: `MAIN_TINKOFF_TOKEN="..." TINKOFF_CONFIG="..." ./target/release/tinkoff_ass`

Сразу запуск: `MAIN_TINKOFF_TOKEN="..." TINKOFF_CONFIG="..." cargo run --release`

Даем команде следующие переменные окружения:
- MAIN_TINKOFF_TOKEN - токен доступа к Tinkoff Invest API
- TINKOFF_CONFIG - путь до файла конфигурации

Создаем файл конфигурации такого вида:
```yaml
assets:
	- allocation: 70
	  ticker: TMOS
	- allocation: 30
	  ticker: TGLD
```

Можно указывать произвольное количество аллокаций. Поле `allocation` задает проценты, должно быть в пределах от 0 до 255, сумма полей в конфиге не должна превышать 100. Если сумма меньше 100, то программа может работать некорректно, этот случай я не проверял, т.к. не был нужен.

Программа считает необходимость произвести перераспределение по классическому правилу 5/25:
- Для аллокаций больше 20%, если актив отклонился от общего капитала на 5%, то надо перераспределять
- Для аллокаций 20% и меньше, если актив отклонился от капитала на 5% от процента распределения, то надо перераспределять.

Перераспределение считается, если отклонился хотя бы один актив.

Если необходимо перераспределение, то программа выводит дополнительные данные, среди которых основным является значение `lot_change`, отрицательное значение показывает сколько надо продать лотов, положительное - сколько купить.
